#! /usr/bin/make -f

RUBY_SITEARCH := $(shell ruby1.8 -rrbconfig -e 'puts Config::CONFIG["sitearch"]')

override_dh_install:
	dh_install --list-missing

override_dh_strip:
	dh_strip --dbg-package=ruby-qt4-dbg

override_dh_auto_clean:
	dh_auto_clean --builddirectory=obj-ruby18
	dh_auto_clean --builddirectory=obj-ruby191

override_dh_auto_configure:
	dh_auto_configure --builddirectory=obj-ruby18  -- -DRUBY_EXECUTABLE=/usr/bin/ruby1.8 \
                                                          -DCUSTOM_RUBY_SITE_LIB_DIR=/usr/lib/ruby/1.8/ \
                                                          -DCUSTOM_RUBY_SITE_ARCH_DIR=/usr/lib/ruby/1.8/$(RUBY_SITEARCH)
	dh_auto_configure --builddirectory=obj-ruby191 -- -DRUBY_EXECUTABLE=/usr/bin/ruby1.9.1 -DRUBY_LIBRARY=/usr/lib/libruby-1.9.1.so

override_dh_auto_build:
	dh_auto_build --builddirectory=obj-ruby18
	dh_auto_build --builddirectory=obj-ruby191

override_dh_auto_install:
	dh_auto_install --builddirectory=obj-ruby18
	dh_auto_install --builddirectory=obj-ruby191

override_dh_compress:
	dh_compress -X.rb -X.ui -X.mng -X.xbel

override_dh_installexamples:
	dh_installexamples
	tar cvzf $(CURDIR)/debian/ruby-qt4/usr/share/doc/ruby-qt4/examples.tar.gz examples

#Build-Depend on debhelper (>= 7.4.10) for --parallel
#Build-Depend on pkg-kde-tools (>= 0.6.8) for the sodeps addon
%:
	dh $@ --parallel --with sodeps

